{% extends "base.html" %}
{% block title %}{{ titulo }} - Veris{% endblock %}
{% block body_class %}veris-tabla-body{% endblock %}
{% block content %}
  <main class="container my-4 veris-tabla-container">
    <h2 class="veris-tabla-title">{{ titulo }}</h2>

    {% if base_path %}
      <p class="veris-tabla-actions">
        <a href="{{ base_path }}/new" class="btn veris-tabla-btn-crear">Crear nuevo</a>
      </p>
    {% endif %}

    <div class="veris-tabla-wrapper">
      <table class="table veris-tabla table-bordered table-striped">
        <thead class="veris-tabla-thead">
          <tr>
            {% for col in columnas %}
              <th>{{ col }}</th>
            {% endfor %}
            {% if base_path and pk_name %}
              <th>Acciones</th>
            {% endif %}
          </tr>
        </thead>
        <tbody class="veris-tabla-body-content">
          {% for fila in datos %}
            <tr>
              {% for col in columnas %}
                <td>
                  {% if col == 'Foto' and fila.get(col) %}
                    <img src="{{ url_for('static', filename='img/usuarios/' ~ fila.get(col)) }}" alt="Foto" width="50" class="veris-tabla-img" onerror="this.style.display='none'" />
                    <div><small class="text-muted">{{ fila[col] }}</small></div>
                  {% else %}
                    {{ fila[col] }}
                  {% endif %}
                </td>
              {% endfor %}

              {% if base_path and pk_name %}
                <td class="veris-tabla-acciones">
                  <a href="{{ base_path }}/{{ fila[pk_name] }}/edit" class="btn btn-sm veris-tabla-btn editar">Editar</a>
                  <form method="post" action="{{ base_path }}/{{ fila[pk_name] }}/delete" style="display:inline" onsubmit="return confirm('Â¿Eliminar este registro?');">
                    <button class="btn btn-sm veris-tabla-btn eliminar" type="submit">Eliminar</button>
                  </form>
                </td>
              {% endif %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </main>
{% endblock %}
